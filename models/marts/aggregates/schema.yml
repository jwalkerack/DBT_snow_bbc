version: 2

models:
  - name: agg_league
    description: >
      This aggregate table summarizes team performance across all matches. 
      It includes overall statistics, home and away breakdowns, and total points 
      for each team within their respective leagues.

    columns:
      - name: TEAM_ID
        description: "Unique identifier for the team, linked to `dim_teams`."
        tests:
          - not_null
          - relationships:
              to: ref('dim_teams')
              field: TEAM_ID

      - name: TEAM_NAME
        description: "Full name of the team."
        tests:
          - not_null

      - name: Formal_League_Name
        description: "The official name of the league : English Premiership."
        tests:
          - not_null

      - name: COUNTRY_NAME
        description: "The country associated with the team's league."
        tests:
          - not_null

      - name: short_League_Name
        description: "The abbreviated version of the league name:  Premiership "
        tests:
          - not_null

      - name: GamesPlayed
        description: "Total number of matches played by the team."
        tests:
          - not_null

      - name: TotalPoints
        description: "Total points accumulated by the team (3 for a win, 1 for a draw, 0 for a loss)."
        tests:
          - not_null

      - name: Wins
        description: "Total matches won by the team."
        tests:
          - not_null

      - name: Losses
        description: "Total matches lost by the team."
        tests:
          - not_null

      - name: Draws
        description: "Total matches drawn by the team."
        tests:
          - not_null

      - name: TotalScored
        description: "Total goals scored by the team."
        tests:
          - not_null

      - name: TotalConceded
        description: "Total goals conceded by the team."
        tests:
          - not_null

      - name: HomeGamesPlayed
        description: "Total number of home matches played by the team."
        tests:
          - not_null

      - name: HomeWins
        description: "Total number of home matches won by the team."
        tests:
          - not_null

      - name: HomeLosses
        description: "Total number of home matches lost by the team."
        tests:
          - not_null

      - name: HomeDraws
        description: "Total number of home matches drawn by the team."
        tests:
          - not_null

      - name: HomeScored
        description: "Total goals scored by the team in home matches."
        tests:
          - not_null

      - name: HomeConceded
        description: "Total goals conceded by the team in home matches."
        tests:
          - not_null

      - name: HomePoints
        description: "Total points earned in home matches."
        tests:
          - not_null

      - name: AwayGamesPlayed
        description: "Total number of away matches played by the team."
        tests:
          - not_null

      - name: AwayWins
        description: "Total number of away matches won by the team."
        tests:
          - not_null

      - name: AwayLosses
        description: "Total number of away matches lost by the team."
        tests:
          - not_null

      - name: AwayDraws
        description: "Total number of away matches drawn by the team."
        tests:
          - not_null

      - name: AwayScored
        description: "Total goals scored by the team in away matches."
        tests:
          - not_null

      - name: AwayConceded
        description: "Total goals conceded by the team in away matches."
        tests:
          - not_null

      - name: AwayPoints
        description: "Total points earned in away matches."
        tests:
          - not_null
